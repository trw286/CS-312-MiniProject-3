<!-- include header -->
<%- include('../partials/_header') %>

<section class="container">

	<h1 class="mb-2">Blog Feed</h1>

	<!-- empty state -->
	<% if (!posts || posts.length === 0) { %>
		<p>No posts yet.</p>

	<% } else { %>

		<!-- iterate through post list and display -->
		<ul class="post-list">

		<% posts.forEach(post => { %>

			<li class="post-item card mb-3">
			<div class="card-body">
				<h3 class="h5"><%= post.title %></h3>

				<!-- post information -->
				<p class="text-muted small">
				by <strong><%= post.creator_name %></strong>
				Â· <%= new Date(post.date_created).toLocaleString() %>
				</p>
				<p><%= post.body %></p>

				<!-- owner only actions (update/delete) -->
				<% if (currentUser && currentUser.user_id === post.creator_user_id) { %>

				<div class="actions mt-2">
					<a class="btn btn-secondary" href="/posts/<%= post.blog_id %>/edit">Edit</a>
					<form action="/posts/<%= post.blog_id %>?_method=DELETE" method="POST" style="display:inline">
					<button class="btn btn-danger" type="submit" onclick="return confirm('Delete this post?')">Delete</button>
					</form>
				</div>

				<% } %>

			</div>
			</li>

		<% }) %>
		</ul>

	<% } %>
</section>

<!-- include header -->
<%- include('../partials/_footer') %>
